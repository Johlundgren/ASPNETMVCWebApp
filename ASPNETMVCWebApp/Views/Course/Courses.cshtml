@model CourseViewModel
@{
    ViewData["Title"] = "Courses";
}

<section class="courses">
    <div class="container">
        <div class="header">
            <h1>Courses</h1>
            <form class="filters">
                <div class="select">
                    <div class="selected">All categories</div>
                    <div class="select-options">
                        <div class="option" data-value="all">All categories</div>
                        @if (Model.Categories != null)
                        {
                            foreach (var category in Model.Categories)
                            {
                                <div class="option" data-value="@category.CategoryName">@category.CategoryName</div>
                            }
                        }
                    </div>
                </div>
                <div class="input-search-group">
                    <input id="searchQuery" name="searchQuery" placeholder="Search courses" />
                    <i class="fa-regular fa-search"></i>
                </div>
            </form>
        </div>
        @if (Model.Courses != null)
        {
            <div class="grid">
                    @foreach (var course in Model.Courses)
                    {
                        <div class="coursedetails" onclick="location.href='@Url.Action("Details", "Course", new {course.Id})'">
                        <section id="@course.Id">
                            <div class="course-card">
                                @if (course.IsBestSeller)
                                {
                                    <div class="best-seller">Best Seller</div>
                                }

                                <div class="join">
                                    <a asp-controller="" asp-action="" asp-route-id=""><i class="fa-light fa-bookmark"></i></a>
                                </div>
                                <div class="image-container">
                                    <img src="~/images/courseimages/@course.ImageUrl" alt="">
                                </div>

                                <div class="content">
                                    <p class="h5">@course.Title</p>
                                    <p class="text-s">@course.Author</p>
                                    <div class="price-flex">
                                        @if (!string.IsNullOrEmpty(course.DiscountPrice) && course.DiscountPrice != "0")
                                        {
                                            <p class="discount-price">$@course.DiscountPrice</p>
                                            <p class="original-price crossed">$@course.Price</p>
                                        }
                                        else
                                        {
                                            <p class="price">$@course.Price</p>
                                        }
                                    </div>
                                    <div class="divider"></div>

                                    <footer>
                                        <div><p class="text-s"><i class="fa-regular fa-clock"></i> @course.Hours hours</p></div>
                                        <div>
                                            <p class="text-s">
                                                <i class="fa-regular fa-thumbs-up"></i>
                                                @{
                                                    double likesCount = 0;
                                                    if (double.TryParse(course.LikesInNumbers, out double likesNumber))
                                                    {
                                                        likesCount = likesNumber / 1000;
                                                    }
                                                }
                                                @course.LikesInProcent% (@likesCount.ToString("0.0") k)
                                            </p>
                                        </div>
                                    </footer>
                                </div>
                            </div>
                        </section>
                    </div>
                    }
               
            </div>
            @if (Model.Pagination != null && Model.Pagination.TotalPages > 1)
            {
              <div class="pagination">
                    @for (int i = 1; i <= Model.Pagination.TotalPages; i++)
                    {
                        if (i == Model.Pagination.CurrentPage)
                        {
                            <span class="btn btn-gray active">@i</span>
                        }
                        else
                        {
                            <a class="btn btn-gray" href="@Url.Action("Courses", new { pageNumber = i, pageSize = Model.Pagination.PageSize })">@i</a>
                        }
                    }
                </div>
            }
        }
    </div>
</section>
@await Html.PartialAsync("~/Views/Shared/Partials/_WorkWithUsPartial.cshtml")
